<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiches Mémoires - Harcèlement</title>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: #333;
            background-attachment: fixed;
            position: relative;
            overflow-x: hidden;
            transition: all 0.3s ease;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 50%, #1a202c 100%);
            color: #e2e8f0;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            animation: float 6s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-10vh) rotate(360deg);
                opacity: 0;
            }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: #f39c12;
            top: -10px;
            z-index: 1000;
            pointer-events: none;
        }

        .confetti:nth-child(odd) {
            background: #e74c3c;
            width: 8px;
            height: 8px;
            animation: confetti-fall 3s linear infinite;
        }

        .confetti:nth-child(even) {
            background: #3498db;
            width: 6px;
            height: 6px;
            animation: confetti-fall 2.5s linear infinite;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .sound-wave {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 60px;
            height: 60px;
            opacity: 0;
            pointer-events: none;
        }

        .sound-wave::before,
        .sound-wave::after {
            content: '';
            position: absolute;
            border: 2px solid #4CAF50;
            border-radius: 50%;
            animation: sound-pulse 0.6s ease-out;
        }

        .sound-wave::before {
            width: 100%;
            height: 100%;
        }

        .sound-wave::after {
            width: 140%;
            height: 140%;
            top: -20%;
            left: -20%;
            animation-delay: 0.2s;
        }

        @keyframes sound-pulse {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 0;
            }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 10px;
            position: relative;
            z-index: 10;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.3);
        }

        .interactive-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .simulator {
            display: none;
            text-align: center;
            color: white;
        }

        .simulator.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .scenario-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .scenario-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .choice-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-align: left;
        }

        .choice-btn:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .choice-btn.correct {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .choice-btn.incorrect {
            background: linear-gradient(135deg, #f56565, #e53e3e);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .mood-meter {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .mood-faces {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 10px;
        }

        .mood-face {
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
        }

        .mood-face:hover {
            transform: scale(1.2);
            background: rgba(255, 255, 255, 0.2);
        }

        .mood-face.selected {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .tips-carousel {
            position: relative;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
            overflow: hidden;
        }

        .tip-slide {
            display: none;
            text-align: center;
            animation: slideIn 0.5s ease;
        }

        .tip-slide.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .tip-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .tip-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ccc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tip-dot.active {
            background: #667eea;
            transform: scale(1.2);
        }

        .breathing-exercise {
            text-align: center;
            padding: 30px;
        }

        .breathing-circle {
            width: 150px;
            height: 150px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: white;
            transition: all 4s ease-in-out;
        }

        .breathing-circle.inhale {
            transform: scale(1.3);
            background: rgba(72, 187, 120, 0.3);
            border-color: #48bb78;
        }

        .breathing-circle.exhale {
            transform: scale(0.8);
            background: rgba(99, 102, 241, 0.3);
            border-color: #6366f1;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            color: white;
            padding: 20px 0;
        }

        .header h1 {
            font-size: clamp(1.8rem, 4vw, 2.8rem);
            margin-bottom: 10px;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.4);
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: clamp(0.9rem, 2vw, 1.1rem);
            opacity: 0.9;
            margin: 0;
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 4px;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            height: 20px;
            border-radius: 20px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .stat-card {
            background: rgba(255,255,255,0.95);
            padding: 20px 15px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.2);
        }

        .stat-number {
            font-size: clamp(1.5rem, 3vw, 2.2rem);
            font-weight: 800;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: clamp(0.8rem, 1.5vw, 0.95rem);
            color: #555;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 30px;
        }

        .card-container {
            perspective: 1000px;
            margin-bottom: 30px;
        }

        .flashcard {
            width: min(450px, 90vw);
            height: min(280px, 40vh);
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            margin: 0 auto;
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .flashcard:hover {
            transform: scale(1.02);
        }

        .flashcard.flipped:hover {
            transform: rotateY(180deg) scale(1.02);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 25px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: clamp(20px, 4vw, 35px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            font-weight: 600;
            border: 2px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
        }

        .card-front {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #ffecd2 100%);
            color: #2d3748;
        }

        .card-front .emoji {
            font-size: clamp(2rem, 6vw, 3.5rem);
            margin-bottom: 15px;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
        }

        .card-front .term {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .card-back {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #d299c2 100%);
            color: #2d3748;
            transform: rotateY(180deg);
            font-size: clamp(0.9rem, 2.2vw, 1.05rem);
            line-height: 1.6;
            padding: clamp(25px, 5vw, 40px);
        }

        .card-back .definition {
            max-height: 100%;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: rgba(0,0,0,0.2) transparent;
        }

        .card-back .definition::-webkit-scrollbar {
            width: 4px;
        }

        .card-back .definition::-webkit-scrollbar-track {
            background: transparent;
        }

        .card-back .definition::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.2);
            border-radius: 2px;
        }

        .controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
            padding: 0 10px;
        }

        .btn {
            padding: clamp(10px, 2vw, 14px) clamp(18px, 4vw, 28px);
            border: none;
            border-radius: 30px;
            font-size: clamp(0.85rem, 2vw, 1rem);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border: 2px solid rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            min-width: clamp(100px, 20vw, 140px);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #f56565 0%, #e53e3e 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #718096 0%, #4a5568 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }

        .btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .btn:disabled:hover {
            transform: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .results {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-top: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            display: none;
        }

        .results.show {
            display: block;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .score-display {
            text-align: center;
            margin-bottom: 25px;
        }

        .final-score {
            font-size: 3rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .score-message {
            font-size: 1.2rem;
            color: #666;
        }

        .term-review {
            margin-top: 25px;
        }

        .term-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .term-status {
            font-weight: bold;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
        }

        .correct {
            background: #d4edda;
            color: #155724;
        }

        .incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 0 5px;
            }
            
            .header {
                margin-bottom: 20px;
                padding: 15px 0;
            }
            
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin-bottom: 20px;
            }
            
            .stat-card {
                padding: 15px 10px;
            }
            
            .controls {
                gap: 8px;
                margin-bottom: 15px;
            }
            
            .card-container {
                margin-bottom: 20px;
            }
            
            .results {
                padding: 20px 15px;
                margin-top: 15px;
            }
            
            .term-item {
                padding: 12px;
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .term-status {
                align-self: flex-end;
            }
        }

        @media (max-width: 480px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            
            .btn {
                width: 100%;
                max-width: 280px;
            }
            
            .progress-bar {
                margin: 15px 0;
            }
        }

        /* Chatbot Styles */
        .chatbot-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            color: #333;
            max-height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            max-height: 300px;
            padding: 10px;
        }

        .bot-message, .user-message {
            display: flex;
            margin-bottom: 15px;
            animation: messageSlide 0.3s ease;
        }

        .user-message {
            justify-content: flex-end;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .user-message .message-avatar {
            margin-left: 10px;
            margin-right: 0;
        }

        .message-content {
            background: #f0f0f0;
            padding: 12px 16px;
            border-radius: 18px;
            max-width: 70%;
            line-height: 1.4;
        }

        .user-message .message-content {
            background: #667eea;
            color: white;
        }

        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-input-container {
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #667eea;
        }

        /* Emotion Detector Styles */
        .emotion-detector {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
            text-align: center;
        }

        .scanner-frame {
            width: 200px;
            height: 200px;
            border: 3px solid #667eea;
            border-radius: 15px;
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
        }

        .scanning-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #4CAF50, transparent);
            animation: scan 2s linear infinite;
            opacity: 0;
        }

        .scanning-line.active {
            opacity: 1;
        }

        @keyframes scan {
            0% { transform: translateY(0); }
            100% { transform: translateY(200px); }
        }

        .emotion-results {
            margin: 20px 0;
            text-align: left;
        }

        .emotion-bar {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 15px;
        }

        .emotion-bar span:first-child {
            width: 80px;
            font-weight: bold;
        }

        .bar {
            flex: 1;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .fill {
            height: 100%;
            transition: width 1s ease;
            border-radius: 10px;
        }

        .fill.joy { background: linear-gradient(90deg, #FFD700, #FFA500); }
        .fill.sadness { background: linear-gradient(90deg, #4169E1, #1E90FF); }
        .fill.stress { background: linear-gradient(90deg, #FF6347, #FF4500); }
        .fill.confidence { background: linear-gradient(90deg, #32CD32, #228B22); }

        .emotion-bar .percentage {
            width: 40px;
            text-align: right;
            font-weight: bold;
        }

        .emotion-advice {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            display: none;
        }

        .emotion-advice.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        /* Mini-Games Styles */
        .mini-games {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
        }

        .game-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .game-area {
            text-align: center;
            padding: 20px;
        }

        .memory-sequence, .memory-input {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .emotion-tile {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .emotion-tile:hover {
            transform: scale(1.1);
        }

        .emotion-tile.active {
            border-color: #667eea;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .emotion-tile.correct {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.2);
        }

        .emotion-tile.incorrect {
            border-color: #f44336;
            background: rgba(244, 67, 54, 0.2);
        }

        .reaction-area {
            margin: 30px 0;
        }

        .reaction-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f44336;
            color: white;
        }

        .reaction-circle.ready {
            background: #4CAF50;
        }

        .reaction-circle.clicked {
            transform: scale(0.9);
        }

        .empathy-face {
            font-size: 8rem;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        .empathy-choices {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .empathy-choice {
            padding: 10px 20px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .empathy-choice:hover {
            background: #667eea;
            color: white;
        }

        .game-score, .reaction-time {
            font-size: 1.2rem;
            font-weight: bold;
            color: #667eea;
            margin: 20px 0;
        }

        /* Badge System Styles */
        .badge-system {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
        }

        .badge-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .badge-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .badge-item.locked {
            opacity: 0.5;
            filter: grayscale(100%);
        }

        .badge-item.unlocked {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            border-color: #FF8C00;
            transform: scale(1.05);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
            animation: badgeUnlock 0.8s ease;
        }

        @keyframes badgeUnlock {
            0% { transform: scale(0.8) rotate(-10deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1.05) rotate(0deg); opacity: 1; }
        }

        .badge-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .badge-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .badge-desc {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .progress-summary {
            text-align: center;
        }

        .overall-progress {
            margin: 20px 0;
        }

        .progress-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg, #667eea 0deg, #e0e0e0 0deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            position: relative;
            transition: background 1s ease;
        }

        .progress-circle::before {
            content: '';
            position: absolute;
            width: 80px;
            height: 80px;
            background: white;
            border-radius: 50%;
        }

        .progress-circle span {
            position: relative;
            z-index: 1;
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .game-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .badge-grid {
                grid-template-columns: 1fr;
            }
            
            .emotion-bar {
                flex-direction: column;
                gap: 5px;
                align-items: flex-start;
            }
            
            .emotion-bar span:first-child {
                width: auto;
            }
            
            .scanner-frame {
                width: 150px;
                height: 150px;
                font-size: 3rem;
            }
            
            .empathy-face {
                font-size: 6rem;
            }
            
            .reaction-circle {
                width: 150px;
                height: 150px;
            }
        }

        /* New Features Styles */
        .quote-generator, .personal-journal, .meditation-center, .avatar-creator, .ambient-sounds, .interactive-stories {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: #333;
        }

        .quote-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .quote-text {
            font-size: 1.3rem;
            font-style: italic;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .quote-author {
            font-size: 1rem;
            opacity: 0.8;
            font-weight: bold;
        }

        .quote-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        #journalText {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            outline: none;
            transition: border-color 0.3s ease;
        }

        #journalText:focus {
            border-color: #667eea;
        }

        .journal-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .journal-stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            min-width: 80px;
        }

        .stat-item .stat-number {
            display: block;
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-item .stat-label {
            font-size: 0.9rem;
            color: #666;
            text-transform: uppercase;
        }

        .meditation-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .meditation-visual {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .meditation-circle {
            width: 150px;
            height: 150px;
            border: 4px solid #667eea;
            border-radius: 50%;
            animation: meditationPulse 4s infinite ease-in-out;
        }

        @keyframes meditationPulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        .meditation-text {
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .meditation-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .meditation-timer {
            text-align: center;
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            margin-top: 20px;
        }

        .avatar-display {
            width: 200px;
            height: 250px;
            margin: 20px auto;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .avatar-face, .avatar-body, .avatar-accessory {
            font-size: 3rem;
            margin: 5px 0;
        }

        .avatar-customization {
            margin: 30px 0;
        }

        .customization-section {
            margin-bottom: 25px;
        }

        .customization-section h4 {
            text-align: center;
            margin-bottom: 15px;
            color: #667eea;
        }

        .option-grid {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .avatar-option {
            width: 60px;
            height: 60px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .avatar-option:hover, .avatar-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
            transform: scale(1.1);
        }

        .sound-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .sound-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .sound-card:hover {
            background: #e9ecef;
            transform: translateY(-5px);
        }

        .sound-card.active {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .sound-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .sound-name {
            font-weight: bold;
            margin-bottom: 15px;
        }

        .sound-visualizer {
            height: 40px;
            background: #e0e0e0;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .sound-visualizer.active {
            background: linear-gradient(90deg, #667eea, #764ba2);
            animation: soundWave 2s infinite ease-in-out;
        }

        @keyframes soundWave {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .sound-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #volumeSlider {
            width: 100px;
        }

        .story-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .story-content {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .story-text {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 25px;
            min-height: 100px;
        }

        .story-choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin: 20px 0;
        }

        .story-choice {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .story-choice:hover {
            background: #667eea;
            color: white;
        }

        .story-progress {
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .quote-text {
                font-size: 1.1rem;
            }
            
            .journal-controls, .meditation-controls, .sound-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .journal-stats {
                flex-direction: column;
                align-items: center;
            }
            
            .sound-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .avatar-display {
                width: 150px;
                height: 200px;
            }
            
            .avatar-face, .avatar-body, .avatar-accessory {
                font-size: 2rem;
            }
        }

        @media (min-width: 1200px) {
            .flashcard {
                width: 500px;
                height: 320px;
            }
            
            .stats {
                grid-template-columns: repeat(4, 1fr);
                max-width: 800px;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>
    
    <button class="theme-toggle" id="themeToggle">🌙</button>

    <div class="container">
        <div class="header">
            <h1>🎯 Fiches Mémoires</h1>
            <p>Apprentissage des termes liés au harcèlement</p>
        </div>

        <!-- Section Interactive : Simulateur de Situations -->
        <div class="interactive-section">
            <h2 style="color: white; text-align: center; margin-bottom: 20px;">🎭 Centre Interactif Anti-Harcèlement</h2>
            <div class="controls" style="justify-content: center; margin-bottom: 20px; flex-wrap: wrap;">
                <button class="btn btn-primary" id="scenarioBtn">🎭 Situations</button>
                <button class="btn btn-success" id="moodBtn">😊 Humeur</button>
                <button class="btn btn-secondary" id="tipsBtn">💡 Conseils</button>
                <button class="btn btn-danger" id="breathingBtn">🌬️ Respiration</button>
                <button class="btn btn-primary" id="chatbotBtn">🤖 Assistant IA</button>
                <button class="btn btn-success" id="emotionBtn">📷 Détecteur</button>
                <button class="btn btn-secondary" id="gameBtn">🎮 Mini-Jeux</button>
                <button class="btn btn-danger" id="badgeBtn">🏆 Badges</button>
                <button class="btn btn-primary" id="quoteBtn">✨ Citations</button>
                <button class="btn btn-success" id="journalBtn">📖 Journal</button>
                <button class="btn btn-secondary" id="meditationBtn">🧘 Méditation</button>
                <button class="btn btn-danger" id="avatarBtn">👤 Avatar</button>
                <button class="btn btn-primary" id="musicBtn">🎵 Ambiance</button>
                <button class="btn btn-success" id="storyBtn">📚 Histoires</button>
            </div>

            <!-- Simulateur de Scénarios -->
            <div class="simulator" id="scenarioSim">
                <div class="scenario-container" id="scenarioContainer">
                    <div class="scenario-text" id="scenarioText">
                        Chargement du scénario...
                    </div>
                    <div class="choice-buttons" id="choiceButtons"></div>
                    <div class="feedback" id="scenarioFeedback"></div>
                </div>
                <button class="btn btn-primary" id="nextScenario">Nouveau Scénario</button>
            </div>

            <!-- Mètre d'Humeur -->
            <div class="simulator" id="moodSim">
                <div class="mood-meter">
                    <h3 style="color: white; margin-bottom: 20px;">Comment vous sentez-vous aujourd'hui ?</h3>
                    <div class="mood-faces">
                        <div class="mood-face" data-mood="très triste">😢</div>
                        <div class="mood-face" data-mood="triste">😔</div>
                        <div class="mood-face" data-mood="neutre">😐</div>
                        <div class="mood-face" data-mood="content">😊</div>
                        <div class="mood-face" data-mood="très content">😄</div>
                    </div>
                    <div id="moodMessage" style="color: white; font-size: 1.1rem; margin-top: 20px;"></div>
                </div>
            </div>

            <!-- Carrousel de Conseils -->
            <div class="simulator" id="tipsSim">
                <div class="tips-carousel">
                    <div class="tip-slide active">
                        <h3>💪 Conseil #1 : Parler à un adulte de confiance</h3>
                        <p>Si tu es victime ou témoin de harcèlement, n'hésite pas à en parler à un parent, un enseignant ou un conseiller. Ce n'est pas de la délation, c'est de la protection.</p>
                    </div>
                    <div class="tip-slide">
                        <h3>🤝 Conseil #2 : Ne pas rester isolé</h3>
                        <p>Entoure-toi d'amis bienveillants. Le harcèlement prospère dans l'isolement. Rejoins des activités qui te plaisent pour rencontrer des personnes partageant tes intérêts.</p>
                    </div>
                    <div class="tip-slide">
                        <h3>📱 Conseil #3 : Gérer le cyberharcèlement</h3>
                        <p>Bloque les harceleurs, ne réponds pas aux provocations, sauvegarde les preuves et signale les contenus inappropriés sur les plateformes.</p>
                    </div>
                    <div class="tip-slide">
                        <h3>🛡️ Conseil #4 : Développer sa confiance en soi</h3>
                        <p>Pratique des activités qui te valorisent, apprends à dire non fermement, et rappelle-toi que le harcèlement n'est jamais de ta faute.</p>
                    </div>
                    <div class="tip-navigation">
                        <span class="tip-dot active" data-slide="0"></span>
                        <span class="tip-dot" data-slide="1"></span>
                        <span class="tip-dot" data-slide="2"></span>
                        <span class="tip-dot" data-slide="3"></span>
                    </div>
                </div>
            </div>

            <!-- Exercice de Respiration -->
            <div class="simulator" id="breathingSim">
                <div class="breathing-exercise">
                    <h3 style="color: white; margin-bottom: 20px;">🌬️ Exercice de Respiration Anti-Stress</h3>
                    <p style="color: white; margin-bottom: 20px;">Suivez le cercle pour vous détendre</p>
                    <div class="breathing-circle" id="breathingCircle">Respirez</div>
                    <button class="btn btn-success" id="startBreathing">Commencer</button>
                    <button class="btn btn-secondary" id="stopBreathing">Arrêter</button>
                </div>
            </div>

            <!-- Assistant IA Chatbot -->
            <div class="simulator" id="chatbotSim">
                <div class="chatbot-container">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">🤖 Assistant IA - Parlez-moi de vos préoccupations</h3>
                    <div class="chat-messages" id="chatMessages">
                        <div class="bot-message">
                            <div class="message-avatar">🤖</div>
                            <div class="message-content">Bonjour ! Je suis votre assistant virtuel. Comment puis-je vous aider aujourd'hui ? Vous pouvez me parler de harcèlement, de vos émotions, ou me poser des questions.</div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="Tapez votre message ici..." class="chat-input">
                        <button class="btn btn-primary" id="sendMessage">Envoyer</button>
                    </div>
                </div>
            </div>

            <!-- Détecteur d'Émotions -->
            <div class="simulator" id="emotionSim">
                <div class="emotion-detector">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">📷 Détecteur d'Émotions Virtuel</h3>
                    <div class="emotion-scanner">
                        <div class="scanner-frame" id="scannerFrame">
                            <div class="scanning-line"></div>
                            <div class="face-placeholder">😐</div>
                        </div>
                        <div class="emotion-results" id="emotionResults">
                            <div class="emotion-bar">
                                <span>Joie</span>
                                <div class="bar"><div class="fill joy" style="width: 0%"></div></div>
                                <span class="percentage">0%</span>
                            </div>
                            <div class="emotion-bar">
                                <span>Tristesse</span>
                                <div class="bar"><div class="fill sadness" style="width: 0%"></div></div>
                                <span class="percentage">0%</span>
                            </div>
                            <div class="emotion-bar">
                                <span>Stress</span>
                                <div class="bar"><div class="fill stress" style="width: 0%"></div></div>
                                <span class="percentage">0%</span>
                            </div>
                            <div class="emotion-bar">
                                <span>Confiance</span>
                                <div class="bar"><div class="fill confidence" style="width: 0%"></div></div>
                                <span class="percentage">0%</span>
                            </div>
                        </div>
                        <button class="btn btn-success" id="scanEmotion">Scanner mes Émotions</button>
                        <div id="emotionAdvice" class="emotion-advice"></div>
                    </div>
                </div>
            </div>

            <!-- Mini-Jeux -->
            <div class="simulator" id="gameSim">
                <div class="mini-games">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">🎮 Mini-Jeux Éducatifs</h3>
                    <div class="game-selector">
                        <button class="btn btn-primary game-select" data-game="memory">🧠 Mémoire des Émotions</button>
                        <button class="btn btn-success game-select" data-game="reaction">⚡ Test de Réaction</button>
                        <button class="btn btn-secondary game-select" data-game="empathy">❤️ Défi Empathie</button>
                    </div>
                    
                    <!-- Memory Game -->
                    <div class="game-area" id="memoryGame" style="display: none;">
                        <h4 style="color: white;">Mémorisez les émotions dans l'ordre !</h4>
                        <div class="memory-sequence" id="memorySequence"></div>
                        <div class="memory-input" id="memoryInput"></div>
                        <div class="game-score">Score: <span id="memoryScore">0</span></div>
                    </div>

                    <!-- Reaction Game -->
                    <div class="game-area" id="reactionGame" style="display: none;">
                        <h4 style="color: white;">Cliquez quand vous voyez le signal vert !</h4>
                        <div class="reaction-area" id="reactionArea">
                            <div class="reaction-circle" id="reactionCircle">Attendez...</div>
                        </div>
                        <div class="reaction-time">Temps de réaction: <span id="reactionTime">-</span>ms</div>
                    </div>

                    <!-- Empathy Game -->
                    <div class="game-area" id="empathyGame" style="display: none;">
                        <h4 style="color: white;">Identifiez l'émotion de cette personne</h4>
                        <div class="empathy-face" id="empathyFace">😊</div>
                        <div class="empathy-choices" id="empathyChoices"></div>
                        <div class="empathy-score">Score: <span id="empathyScore">0</span></div>
                    </div>
                </div>
            </div>

            <!-- Système de Badges -->
            <div class="simulator" id="badgeSim">
                <div class="badge-system">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">🏆 Vos Badges de Progression</h3>
                    <div class="badge-grid" id="badgeGrid">
                        <div class="badge-item locked" data-badge="first-card">
                            <div class="badge-icon">🎯</div>
                            <div class="badge-name">Première Fiche</div>
                            <div class="badge-desc">Retournez votre première fiche</div>
                        </div>
                        <div class="badge-item locked" data-badge="perfect-score">
                            <div class="badge-icon">⭐</div>
                            <div class="badge-name">Score Parfait</div>
                            <div class="badge-desc">Obtenez 100% de bonnes réponses</div>
                        </div>
                        <div class="badge-item locked" data-badge="emotion-master">
                            <div class="badge-icon">😊</div>
                            <div class="badge-name">Maître des Émotions</div>
                            <div class="badge-desc">Utilisez le détecteur d'émotions</div>
                        </div>
                        <div class="badge-item locked" data-badge="helper">
                            <div class="badge-icon">🤝</div>
                            <div class="badge-name">Assistant Virtuel</div>
                            <div class="badge-desc">Discutez avec l'IA</div>
                        </div>
                        <div class="badge-item locked" data-badge="zen-master">
                            <div class="badge-icon">🧘</div>
                            <div class="badge-name">Maître Zen</div>
                            <div class="badge-desc">Complétez un exercice de respiration</div>
                        </div>
                        <div class="badge-item locked" data-badge="gamer">
                            <div class="badge-icon">🎮</div>
                            <div class="badge-name">Joueur Expert</div>
                            <div class="badge-desc">Jouez à tous les mini-jeux</div>
                        </div>
                    </div>
                    <div class="progress-summary">
                        <h4 style="color: white;">Progression Globale</h4>
                        <div class="overall-progress">
                            <div class="progress-circle" id="overallProgress">
                                <span id="progressPercent">0%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Citations Inspirantes -->
            <div class="simulator" id="quoteSim">
                <div class="quote-generator">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">✨ Citations Inspirantes</h3>
                    <div class="quote-card" id="quoteCard">
                        <div class="quote-text" id="quoteText">Cliquez pour découvrir une citation inspirante</div>
                        <div class="quote-author" id="quoteAuthor"></div>
                    </div>
                    <button class="btn btn-success" id="newQuote">Nouvelle Citation</button>
                    <div class="quote-actions">
                        <button class="btn btn-primary" id="favoriteQuote">❤️ Favori</button>
                        <button class="btn btn-secondary" id="shareQuote">📤 Partager</button>
                    </div>
                </div>
            </div>

            <!-- Journal Personnel -->
            <div class="simulator" id="journalSim">
                <div class="personal-journal">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">📖 Mon Journal Personnel</h3>
                    <div class="journal-entry">
                        <textarea id="journalText" placeholder="Écrivez vos pensées, vos sentiments, vos expériences... Ce journal est privé et vous appartient."></textarea>
                        <div class="journal-controls">
                            <button class="btn btn-success" id="saveEntry">💾 Sauvegarder</button>
                            <button class="btn btn-secondary" id="clearEntry">🗑️ Effacer</button>
                            <button class="btn btn-primary" id="moodTracker">😊 Humeur du jour</button>
                        </div>
                    </div>
                    <div class="journal-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="entriesCount">0</span>
                            <span class="stat-label">Entrées</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="wordsCount">0</span>
                            <span class="stat-label">Mots</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="streakCount">0</span>
                            <span class="stat-label">Jours consécutifs</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Méditation Guidée -->
            <div class="simulator" id="meditationSim">
                <div class="meditation-center">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">🧘 Méditation Guidée</h3>
                    <div class="meditation-selector">
                        <button class="btn btn-primary meditation-type" data-type="stress">🌊 Anti-Stress</button>
                        <button class="btn btn-success meditation-type" data-type="confidence">💪 Confiance</button>
                        <button class="btn btn-secondary meditation-type" data-type="sleep">😴 Sommeil</button>
                    </div>
                    <div class="meditation-player" id="meditationPlayer">
                        <div class="meditation-visual" id="meditationVisual">
                            <div class="meditation-circle"></div>
                        </div>
                        <div class="meditation-text" id="meditationText">Choisissez un type de méditation</div>
                        <div class="meditation-controls">
                            <button class="btn btn-success" id="startMeditation">▶️ Commencer</button>
                            <button class="btn btn-danger" id="stopMeditation">⏹️ Arrêter</button>
                        </div>
                        <div class="meditation-timer">
                            <span id="meditationTime">00:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Créateur d'Avatar -->
            <div class="simulator" id="avatarSim">
                <div class="avatar-creator">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">👤 Créez Votre Avatar</h3>
                    <div class="avatar-display" id="avatarDisplay">
                        <div class="avatar-face">😊</div>
                        <div class="avatar-body">👕</div>
                        <div class="avatar-accessory">🎒</div>
                    </div>
                    <div class="avatar-customization">
                        <div class="customization-section">
                            <h4>Visage</h4>
                            <div class="option-grid">
                                <button class="avatar-option" data-type="face" data-value="😊">😊</button>
                                <button class="avatar-option" data-type="face" data-value="😎">😎</button>
                                <button class="avatar-option" data-type="face" data-value="🤓">🤓</button>
                                <button class="avatar-option" data-type="face" data-value="😇">😇</button>
                            </div>
                        </div>
                        <div class="customization-section">
                            <h4>Vêtements</h4>
                            <div class="option-grid">
                                <button class="avatar-option" data-type="body" data-value="👕">👕</button>
                                <button class="avatar-option" data-type="body" data-value="👔">👔</button>
                                <button class="avatar-option" data-type="body" data-value="🎽">🎽</button>
                                <button class="avatar-option" data-type="body" data-value="🥼">🥼</button>
                            </div>
                        </div>
                        <div class="customization-section">
                            <h4>Accessoires</h4>
                            <div class="option-grid">
                                <button class="avatar-option" data-type="accessory" data-value="🎒">🎒</button>
                                <button class="avatar-option" data-type="accessory" data-value="🎓">🎓</button>
                                <button class="avatar-option" data-type="accessory" data-value="🎭">🎭</button>
                                <button class="avatar-option" data-type="accessory" data-value="🏆">🏆</button>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-success" id="saveAvatar">💾 Sauvegarder Avatar</button>
                </div>
            </div>

            <!-- Ambiance Sonore -->
            <div class="simulator" id="musicSim">
                <div class="ambient-sounds">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">🎵 Ambiance Sonore</h3>
                    <div class="sound-grid">
                        <div class="sound-card" data-sound="rain">
                            <div class="sound-icon">🌧️</div>
                            <div class="sound-name">Pluie</div>
                            <div class="sound-visualizer" id="rainViz"></div>
                        </div>
                        <div class="sound-card" data-sound="forest">
                            <div class="sound-icon">🌲</div>
                            <div class="sound-name">Forêt</div>
                            <div class="sound-visualizer" id="forestViz"></div>
                        </div>
                        <div class="sound-card" data-sound="ocean">
                            <div class="sound-icon">🌊</div>
                            <div class="sound-name">Océan</div>
                            <div class="sound-visualizer" id="oceanViz"></div>
                        </div>
                        <div class="sound-card" data-sound="birds">
                            <div class="sound-icon">🐦</div>
                            <div class="sound-name">Oiseaux</div>
                            <div class="sound-visualizer" id="birdsViz"></div>
                        </div>
                    </div>
                    <div class="sound-controls">
                        <button class="btn btn-success" id="playAllSounds">▶️ Jouer Tout</button>
                        <button class="btn btn-danger" id="stopAllSounds">⏹️ Arrêter Tout</button>
                        <div class="volume-control">
                            <span>🔊 Volume:</span>
                            <input type="range" id="volumeSlider" min="0" max="100" value="50">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Histoires Interactives -->
            <div class="simulator" id="storySim">
                <div class="interactive-stories">
                    <h3 style="color: white; text-align: center; margin-bottom: 20px;">📚 Histoires Interactives</h3>
                    <div class="story-selector">
                        <button class="btn btn-primary story-select" data-story="courage">🦁 L'Histoire du Courage</button>
                        <button class="btn btn-success story-select" data-story="friendship">🤝 L'Amitié Véritable</button>
                        <button class="btn btn-secondary story-select" data-story="kindness">💝 La Gentillesse</button>
                    </div>
                    <div class="story-content" id="storyContent">
                        <div class="story-text" id="storyText">Choisissez une histoire pour commencer</div>
                        <div class="story-choices" id="storyChoices"></div>
                        <div class="story-progress">
                            <div class="progress-bar">
                                <div class="progress-fill" id="storyProgress" style="width: 0%">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%">0%</div>
        </div>

        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="currentCard">1</div>
                <div class="stat-label">Fiche actuelle</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalCards">15</div>
                <div class="stat-label">Total</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="correctCount">0</div>
                <div class="stat-label">Correctes</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="scoreDisplay">0</div>
                <div class="stat-label">Score</div>
            </div>
        </div>

        <div class="game-area">
            <div class="card-container">
                <div class="flashcard" id="flashcard">
                    <div class="card-face card-front" id="cardFront">
                        <div class="emoji">🎯</div>
                        <div class="term">Cliquez pour commencer !</div>
                    </div>
                    <div class="card-face card-back" id="cardBack">
                        <div class="definition">Définition apparaîtra ici</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="flipBtn">Retourner la fiche</button>
                <button class="btn btn-success" id="correctBtn" disabled>✓ Je savais</button>
                <button class="btn btn-danger" id="incorrectBtn" disabled>✗ Je ne savais pas</button>
                <button class="btn btn-secondary" id="nextBtn" disabled>Suivant</button>
            </div>

            <div class="controls">
                <button class="btn btn-primary" id="startBtn">Commencer</button>
                <button class="btn btn-secondary" id="resetBtn">Recommencer</button>
            </div>
        </div>

        <div class="results" id="results">
            <div class="score-display">
                <div class="final-score" id="finalScore">0%</div>
                <div class="score-message" id="scoreMessage">Excellent travail !</div>
            </div>
            
            <div class="term-review">
                <h3>📋 Révision des termes</h3>
                <div id="termReview"></div>
            </div>
            
            <div style="text-align: center; margin-top: 25px;">
                <button class="btn btn-primary" id="restartBtn">Nouvelle session</button>
            </div>
        </div>
    </div>

    <script>
        const flashcards = [
            {
                term: "Harcèlement scolaire",
                definition: "Violence répétée, physique ou psychologique, exercée par un ou plusieurs élèves à l'encontre d'un autre élève qui ne peut se défendre. Il se caractérise par l'intentionnalité, la répétition et la relation d'asymétrie.",
                emoji: "🏫"
            },
            {
                term: "Cyberharcèlement",
                definition: "Forme de harcèlement qui utilise les technologies numériques (réseaux sociaux, messageries, jeux en ligne). Il peut se poursuivre 24h/24 et toucher la victime même dans son espace privé.",
                emoji: "💻"
            },
            {
                term: "Victime",
                definition: "Personne qui subit des actes de harcèlement. Elle peut présenter des signes de détresse, d'isolement, de baisse des résultats scolaires, et développer des troubles anxieux ou dépressifs.",
                emoji: "😢"
            },
            {
                term: "Agresseur",
                definition: "Personne qui commet des actes de harcèlement. Il peut agir seul ou en groupe, cherche souvent à dominer et peut avoir des difficultés à gérer ses émotions ou à faire preuve d'empathie.",
                emoji: "😠"
            },
            {
                term: "Mesures de prévention",
                definition: "Actions mises en place pour éviter le harcèlement : sensibilisation, formation, règles claires, climat scolaire bienveillant, programmes d'éducation aux émotions et aux relations sociales.",
                emoji: "🛡️"
            },
            {
                term: "Témoin",
                definition: "Personne qui assiste à des actes de harcèlement. Son rôle est crucial : il peut soit renforcer le harcèlement par son silence, soit l'arrêter en intervenant ou en alertant un adulte.",
                emoji: "👁️"
            },
            {
                term: "Isolement social",
                definition: "Stratégie de harcèlement consistant à exclure délibérément une personne du groupe, à l'ignorer ou à convaincre les autres de ne pas lui parler.",
                emoji: "🚫"
            },
            {
                term: "Harcèlement physique",
                definition: "Actes de violence corporelle répétés : coups, bousculades, destruction de matériel, vol d'affaires personnelles. Laisse souvent des traces visibles.",
                emoji: "✊"
            },
            {
                term: "Harcèlement verbal",
                definition: "Insultes, moqueries, menaces, humiliations publiques, commentaires déplacés sur l'apparence, les origines ou les capacités de la victime.",
                emoji: "🗣️"
            },
            {
                term: "Harcèlement relationnel",
                definition: "Manipulation des relations sociales pour nuire : propagation de rumeurs, exclusion du groupe, chantage affectif, atteinte à la réputation.",
                emoji: "💔"
            },
            {
                term: "Effet de groupe",
                definition: "Phénomène où des individus adoptent des comportements qu'ils n'auraient pas eus seuls. Dans le harcèlement, cela amplifie la violence et réduit le sentiment de responsabilité.",
                emoji: "👥"
            },
            {
                term: "Empathie",
                definition: "Capacité à comprendre et partager les émotions d'autrui. Son développement est essentiel pour prévenir le harcèlement et favoriser des relations respectueuses.",
                emoji: "❤️"
            },
            {
                term: "Signalement",
                definition: "Action d'informer un adulte de confiance (parent, enseignant, CPE) d'une situation de harcèlement. Ce n'est pas de la délation mais un acte de protection.",
                emoji: "📢"
            },
            {
                term: "Climat scolaire",
                definition: "Ambiance générale d'un établissement scolaire. Un climat positif, basé sur le respect et la bienveillance, réduit considérablement les risques de harcèlement.",
                emoji: "🌟"
            },
            {
                term: "Résilience",
                definition: "Capacité à surmonter les épreuves et à se reconstruire après un traumatisme. Elle peut être développée chez les victimes avec un accompagnement approprié.",
                emoji: "🌱"
            }
        ];

        let currentCardIndex = 0;
        let isFlipped = false;
        let gameStarted = false;
        let results = [];
        let score = 0;

        const elements = {
            flashcard: document.getElementById('flashcard'),
            cardFront: document.getElementById('cardFront'),
            cardBack: document.getElementById('cardBack'),
            flipBtn: document.getElementById('flipBtn'),
            correctBtn: document.getElementById('correctBtn'),
            incorrectBtn: document.getElementById('incorrectBtn'),
            nextBtn: document.getElementById('nextBtn'),
            startBtn: document.getElementById('startBtn'),
            resetBtn: document.getElementById('resetBtn'),
            currentCard: document.getElementById('currentCard'),
            totalCards: document.getElementById('totalCards'),
            correctCount: document.getElementById('correctCount'),
            scoreDisplay: document.getElementById('scoreDisplay'),
            progressFill: document.getElementById('progressFill'),
            results: document.getElementById('results'),
            finalScore: document.getElementById('finalScore'),
            scoreMessage: document.getElementById('scoreMessage'),
            termReview: document.getElementById('termReview'),
            restartBtn: document.getElementById('restartBtn')
        };

        function updateStats() {
            const correctAnswers = results.filter(r => r.correct).length;
            const progress = ((currentCardIndex) / flashcards.length) * 100;
            
            elements.currentCard.textContent = Math.min(currentCardIndex + 1, flashcards.length);
            elements.correctCount.textContent = correctAnswers;
            elements.scoreDisplay.textContent = Math.round((correctAnswers / Math.max(results.length, 1)) * 100);
            elements.progressFill.style.width = progress + '%';
            elements.progressFill.textContent = Math.round(progress) + '%';
        }

        function loadCard() {
            if (currentCardIndex >= flashcards.length) {
                showResults();
                return;
            }

            const card = flashcards[currentCardIndex];
            elements.cardFront.innerHTML = `
                <div class="emoji">${card.emoji}</div>
                <div class="term">${card.term}</div>
            `;
            elements.cardBack.innerHTML = `
                <div class="definition">${card.definition}</div>
            `;
            
            // Reset card state
            elements.flashcard.classList.remove('flipped');
            isFlipped = false;
            
            // Reset buttons
            elements.flipBtn.disabled = false;
            elements.correctBtn.disabled = true;
            elements.incorrectBtn.disabled = true;
            elements.nextBtn.disabled = true;
            
            updateStats();
        }

        function flipCard() {
            if (!gameStarted) return;
            
            elements.flashcard.classList.toggle('flipped');
            isFlipped = !isFlipped;
            
            if (isFlipped) {
                elements.flipBtn.disabled = true;
                elements.correctBtn.disabled = false;
                elements.incorrectBtn.disabled = false;
                
                // Unlock first card badge
                if (currentCardIndex === 0 && results.length === 0) {
                    unlockBadge('first-card');
                }
            }
        }

        function answerCard(correct) {
            results.push({
                term: flashcards[currentCardIndex].term,
                definition: flashcards[currentCardIndex].definition,
                correct: correct
            });
            
            elements.correctBtn.disabled = true;
            elements.incorrectBtn.disabled = true;
            elements.nextBtn.disabled = false;
            
            updateStats();
        }

        function nextCard() {
            currentCardIndex++;
            loadCard();
        }

        function startGame() {
            gameStarted = true;
            currentCardIndex = 0;
            results = [];
            score = 0;
            
            elements.results.classList.remove('show');
            elements.startBtn.style.display = 'none';
            
            loadCard();
        }

        function resetGame() {
            gameStarted = false;
            currentCardIndex = 0;
            results = [];
            score = 0;
            isFlipped = false;
            
            elements.flashcard.classList.remove('flipped');
            elements.cardFront.innerHTML = `
                <div class="emoji">🎯</div>
                <div class="term">Cliquez pour commencer !</div>
            `;
            elements.cardBack.innerHTML = `
                <div class="definition">Définition apparaîtra ici</div>
            `;
            
            elements.startBtn.style.display = 'inline-block';
            elements.results.classList.remove('show');
            
            // Reset buttons
            elements.flipBtn.disabled = false;
            elements.correctBtn.disabled = true;
            elements.incorrectBtn.disabled = true;
            elements.nextBtn.disabled = true;
            
            // Reset stats
            elements.currentCard.textContent = '1';
            elements.correctCount.textContent = '0';
            elements.scoreDisplay.textContent = '0';
            elements.progressFill.style.width = '0%';
            elements.progressFill.textContent = '0%';
            elements.totalCards.textContent = flashcards.length;
        }

        function showResults() {
            const correctAnswers = results.filter(r => r.correct).length;
            const finalScore = Math.round((correctAnswers / flashcards.length) * 100);
            
            elements.finalScore.textContent = finalScore + '%';
            
            // Check for perfect score badge
            if (finalScore === 100) {
                unlockBadge('perfect-score');
            }
            
            let message = '';
            if (finalScore >= 90) {
                message = '🎉 Excellent ! Vous maîtrisez parfaitement ces concepts !';
            } else if (finalScore >= 70) {
                message = '👍 Très bien ! Quelques révisions et ce sera parfait !';
            } else if (finalScore >= 50) {
                message = '📚 Bon début ! Continuez à réviser pour progresser !';
            } else {
                message = '💪 Ne vous découragez pas ! La pratique mène à la perfection !';
            }
            
            elements.scoreMessage.textContent = message;
            
            // Generate term review
            let reviewHTML = '';
            results.forEach(result => {
                reviewHTML += `
                    <div class="term-item">
                        <div>
                            <strong>${result.term}</strong>
                            <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">
                                ${result.definition}
                            </div>
                        </div>
                        <div class="term-status ${result.correct ? 'correct' : 'incorrect'}">
                            ${result.correct ? '✓ Maîtrisé' : '✗ À revoir'}
                        </div>
                    </div>
                `;
            });
            
            elements.termReview.innerHTML = reviewHTML;
            elements.results.classList.add('show');
        }

        // Event listeners
        elements.flipBtn.addEventListener('click', flipCard);
        elements.flashcard.addEventListener('click', flipCard);
        elements.correctBtn.addEventListener('click', () => answerCard(true));
        elements.incorrectBtn.addEventListener('click', () => answerCard(false));
        elements.nextBtn.addEventListener('click', nextCard);
        elements.startBtn.addEventListener('click', startGame);
        elements.resetBtn.addEventListener('click', resetGame);
        elements.restartBtn.addEventListener('click', resetGame);

        // Scenarios for interactive simulator
        const scenarios = [
            {
                text: "Tu vois un camarade se faire insulter et pousser par un groupe d'élèves dans la cour. Que fais-tu ?",
                choices: [
                    { text: "Je vais chercher un surveillant immédiatement", correct: true },
                    { text: "Je filme la scène avec mon téléphone", correct: false },
                    { text: "Je m'approche et je dis aux agresseurs d'arrêter", correct: false },
                    { text: "Je ne fais rien, ce ne sont pas mes affaires", correct: false }
                ],
                feedback: {
                    correct: "Excellent ! Aller chercher un adulte est la meilleure solution. Tu protèges la victime sans te mettre en danger.",
                    incorrect: "Cette réaction pourrait aggraver la situation ou te mettre en danger. Il vaut mieux chercher un adulte de confiance."
                }
            },
            {
                text: "Tu reçois des messages méchants sur les réseaux sociaux de la part d'un camarade de classe. Comment réagis-tu ?",
                choices: [
                    { text: "Je bloque cette personne et je sauvegarde les messages", correct: true },
                    { text: "Je réponds avec des insultes encore plus fortes", correct: false },
                    { text: "Je partage ces messages pour que tout le monde voie", correct: false },
                    { text: "Je supprime les messages et j'ignore", correct: false }
                ],
                feedback: {
                    correct: "Parfait ! Bloquer et sauvegarder les preuves est la bonne stratégie. Tu peux ensuite en parler à un adulte.",
                    incorrect: "Cette réaction risque d'empirer la situation. Il vaut mieux bloquer, sauvegarder les preuves et en parler à un adulte."
                }
            },
            {
                text: "Un ami te confie qu'il est harcelé mais te demande de ne rien dire à personne. Que fais-tu ?",
                choices: [
                    { text: "Je l'encourage à en parler à un adulte et je l'accompagne", correct: true },
                    { text: "Je respecte sa demande et ne dis rien", correct: false },
                    { text: "Je vais directement voir les harceleurs pour leur parler", correct: false },
                    { text: "Je raconte tout à mes autres amis", correct: false }
                ],
                feedback: {
                    correct: "Très bien ! Encourager et accompagner ton ami vers un adulte de confiance est la meilleure aide que tu puisses lui apporter.",
                    incorrect: "Ton ami a besoin d'aide même s'il a peur. L'encourager à parler à un adulte est essentiel pour sa sécurité."
                }
            }
        ];

        let currentScenario = 0;
        let breathingInterval;
        let currentTipSlide = 0;

        // Interactive elements
        const interactiveElements = {
            themeToggle: document.getElementById('themeToggle'),
            scenarioBtn: document.getElementById('scenarioBtn'),
            moodBtn: document.getElementById('moodBtn'),
            tipsBtn: document.getElementById('tipsBtn'),
            breathingBtn: document.getElementById('breathingBtn'),
            chatbotBtn: document.getElementById('chatbotBtn'),
            emotionBtn: document.getElementById('emotionBtn'),
            gameBtn: document.getElementById('gameBtn'),
            badgeBtn: document.getElementById('badgeBtn'),
            quoteBtn: document.getElementById('quoteBtn'),
            journalBtn: document.getElementById('journalBtn'),
            meditationBtn: document.getElementById('meditationBtn'),
            avatarBtn: document.getElementById('avatarBtn'),
            musicBtn: document.getElementById('musicBtn'),
            storyBtn: document.getElementById('storyBtn'),
            scenarioSim: document.getElementById('scenarioSim'),
            moodSim: document.getElementById('moodSim'),
            tipsSim: document.getElementById('tipsSim'),
            breathingSim: document.getElementById('breathingSim'),
            chatbotSim: document.getElementById('chatbotSim'),
            emotionSim: document.getElementById('emotionSim'),
            gameSim: document.getElementById('gameSim'),
            badgeSim: document.getElementById('badgeSim'),
            quoteSim: document.getElementById('quoteSim'),
            journalSim: document.getElementById('journalSim'),
            meditationSim: document.getElementById('meditationSim'),
            avatarSim: document.getElementById('avatarSim'),
            musicSim: document.getElementById('musicSim'),
            storySim: document.getElementById('storySim'),
            scenarioText: document.getElementById('scenarioText'),
            choiceButtons: document.getElementById('choiceButtons'),
            scenarioFeedback: document.getElementById('scenarioFeedback'),
            nextScenario: document.getElementById('nextScenario'),
            moodFaces: document.querySelectorAll('.mood-face'),
            moodMessage: document.getElementById('moodMessage'),
            breathingCircle: document.getElementById('breathingCircle'),
            startBreathing: document.getElementById('startBreathing'),
            stopBreathing: document.getElementById('stopBreathing'),
            tipDots: document.querySelectorAll('.tip-dot'),
            particles: document.getElementById('particles'),
            chatMessages: document.getElementById('chatMessages'),
            chatInput: document.getElementById('chatInput'),
            sendMessage: document.getElementById('sendMessage'),
            scanEmotion: document.getElementById('scanEmotion'),
            emotionResults: document.getElementById('emotionResults'),
            emotionAdvice: document.getElementById('emotionAdvice'),
            scannerFrame: document.getElementById('scannerFrame'),
            gameSelectors: document.querySelectorAll('.game-select'),
            badgeGrid: document.getElementById('badgeGrid'),
            overallProgress: document.getElementById('overallProgress'),
            progressPercent: document.getElementById('progressPercent')
        };

        // New features data
        const inspirationalQuotes = [
            { text: "La différence entre l'ordinaire et l'extraordinaire, c'est ce petit 'extra'.", author: "Jimmy Johnson" },
            { text: "Soyez vous-même, tous les autres sont déjà pris.", author: "Oscar Wilde" },
            { text: "Le courage n'est pas l'absence de peur, mais la capacité de vaincre ce qui fait peur.", author: "Nelson Mandela" },
            { text: "Croyez en vous et tout devient possible.", author: "Anonyme" },
            { text: "Chaque jour est une nouvelle chance de changer votre vie.", author: "Anonyme" },
            { text: "La gentillesse est un langage que les sourds peuvent entendre et que les aveugles peuvent voir.", author: "Mark Twain" },
            { text: "Vous êtes plus courageux que vous ne le croyez, plus fort que vous ne le paraissez.", author: "A.A. Milne" },
            { text: "Il n'y a personne qui soit né sous une mauvaise étoile, il n'y a que des gens qui ne savent pas lire le ciel.", author: "Dalaï Lama" }
        ];

        const meditationPrograms = {
            stress: {
                name: "Anti-Stress",
                steps: [
                    "Installez-vous confortablement et fermez les yeux...",
                    "Respirez profondément par le nez, retenez 3 secondes...",
                    "Expirez lentement par la bouche...",
                    "Imaginez un lieu paisible où vous vous sentez en sécurité...",
                    "Laissez vos tensions se dissoudre à chaque expiration...",
                    "Vous êtes calme, détendu et en paix..."
                ]
            },
            confidence: {
                name: "Confiance en Soi",
                steps: [
                    "Redressez-vous et respirez avec assurance...",
                    "Pensez à un moment où vous vous êtes senti fier de vous...",
                    "Ressentez cette force intérieure qui grandit...",
                    "Répétez mentalement : 'Je suis capable et fort'...",
                    "Visualisez-vous réussissant vos défis...",
                    "Cette confiance fait partie de vous, elle est réelle..."
                ]
            },
            sleep: {
                name: "Préparation au Sommeil",
                steps: [
                    "Allongez-vous et relâchez tous vos muscles...",
                    "Respirez de plus en plus lentement...",
                    "Votre corps devient lourd et détendu...",
                    "Vos paupières deviennent lourdes...",
                    "Laissez vos pensées s'éloigner comme des nuages...",
                    "Vous glissez doucement vers un sommeil réparateur..."
                ]
            }
        };

        const interactiveStories = {
            courage: {
                title: "L'Histoire du Courage",
                chapters: [
                    {
                        text: "Léa était nouvelle dans son école. Elle remarqua qu'un élève, Tom, était souvent seul et semblait triste. Que devrait-elle faire ?",
                        choices: [
                            { text: "Aller lui parler et lui proposer de déjeuner ensemble", next: 1 },
                            { text: "L'ignorer pour ne pas avoir de problèmes", next: 2 },
                            { text: "En parler à ses amis d'abord", next: 3 }
                        ]
                    },
                    {
                        text: "Léa s'approche de Tom avec un sourire. 'Salut, je suis Léa. Tu veux déjeuner avec moi ?' Tom lève les yeux, surpris mais reconnaissant. C'est le début d'une belle amitié.",
                        choices: [{ text: "Continuer l'histoire", next: 4 }]
                    },
                    {
                        text: "Léa ignore Tom. Plus tard, elle apprend qu'il a changé d'école à cause du harcèlement. Elle regrette de ne pas avoir agi.",
                        choices: [{ text: "Recommencer avec plus de courage", next: 0 }]
                    },
                    {
                        text: "Léa en parle à ses amis. Ensemble, ils décident d'inclure Tom dans leur groupe. L'union fait la force !",
                        choices: [{ text: "Voir la suite", next: 4 }]
                    },
                    {
                        text: "Grâce au courage de Léa, Tom retrouve confiance en lui. Il devient même délégué de classe ! Parfois, un petit geste peut changer une vie entière.",
                        choices: []
                    }
                ]
            },
            friendship: {
                title: "L'Amitié Véritable",
                chapters: [
                    {
                        text: "Marc et Julie sont meilleurs amis depuis l'enfance. Un jour, Marc voit Julie se faire embêter par des élèves plus âgés. Que fait-il ?",
                        choices: [
                            { text: "Il va chercher un adulte immédiatement", next: 1 },
                            { text: "Il affronte seul les harceleurs", next: 2 },
                            { text: "Il encourage Julie à se défendre seule", next: 3 }
                        ]
                    },
                    {
                        text: "Marc court chercher un surveillant. Ensemble, ils règlent la situation calmement. Julie est reconnaissante de cette aide intelligente.",
                        choices: [{ text: "Continuer", next: 4 }]
                    },
                    {
                        text: "Marc se précipite mais se fait aussi embêter. La situation empire. Il aurait mieux valu chercher de l'aide.",
                        choices: [{ text: "Essayer une autre approche", next: 0 }]
                    },
                    {
                        text: "Marc encourage Julie, mais elle a besoin de soutien concret. L'amitié, c'est aussi savoir agir au bon moment.",
                        choices: [{ text: "Recommencer", next: 0 }]
                    },
                    {
                        text: "Leur amitié devient encore plus forte. Ils apprennent qu'être ami, c'est se protéger mutuellement avec intelligence et courage.",
                        choices: []
                    }
                ]
            },
            kindness: {
                title: "La Gentillesse",
                chapters: [
                    {
                        text: "Emma voit une nouvelle élève, Sarah, manger seule à la cantine. Sarah semble timide et triste. Comment Emma peut-elle l'aider ?",
                        choices: [
                            { text: "L'inviter à sa table avec ses amis", next: 1 },
                            { text: "Lui sourire de loin mais ne rien faire", next: 2 },
                            { text: "Lui apporter un dessert en plus", next: 3 }
                        ]
                    },
                    {
                        text: "Emma invite Sarah à sa table. Ses amis l'accueillent chaleureusement. Sarah se sent immédiatement intégrée et sourit pour la première fois.",
                        choices: [{ text: "Suite de l'histoire", next: 4 }]
                    },
                    {
                        text: "Un sourire c'est bien, mais Sarah a besoin de plus. Elle reste seule et triste. Emma réalise qu'elle aurait pu faire mieux.",
                        choices: [{ text: "Faire un vrai geste", next: 0 }]
                    },
                    {
                        text: "Emma offre son dessert à Sarah. C'est un beau geste qui ouvre la conversation. Elles deviennent rapidement amies.",
                        choices: [{ text: "Voir la fin", next: 4 }]
                    },
                    {
                        text: "Grâce à la gentillesse d'Emma, Sarah s'épanouit dans sa nouvelle école. Elle découvre qu'elle a un talent pour le dessin et devient l'illustratrice du journal de l'école !",
                        choices: []
                    }
                ]
            }
        };

        // New features variables
        let currentQuoteIndex = 0;
        let favoriteQuotes = [];
        let journalEntries = [];
        let currentMeditation = null;
        let meditationTimer = null;
        let meditationStep = 0;
        let avatarConfig = { face: '😊', body: '👕', accessory: '🎒' };
        let activeSounds = new Set();
        let currentStory = null;
        let currentChapter = 0;

        // Create floating particles
        function createParticles() {
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                interactiveElements.particles.appendChild(particle);
            }
        }

        // Create confetti effect
        function createConfetti() {
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 3000);
            }
        }

        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            interactiveElements.themeToggle.textContent = isDark ? '☀️' : '🌙';
        }

        // Show simulator section
        function showSimulator(type) {
            // Hide all simulators
            document.querySelectorAll('.simulator').forEach(sim => {
                sim.classList.remove('active');
            });
            
            // Show selected simulator
            interactiveElements[type + 'Sim'].classList.add('active');
            
            if (type === 'scenario') {
                loadScenario();
            } else if (type === 'tips') {
                showTipSlide(0);
            }
        }

        // Load scenario
        function loadScenario() {
            const scenario = scenarios[currentScenario];
            interactiveElements.scenarioText.textContent = scenario.text;
            
            // Clear previous choices
            interactiveElements.choiceButtons.innerHTML = '';
            interactiveElements.scenarioFeedback.classList.remove('show');
            
            // Add choice buttons
            scenario.choices.forEach((choice, index) => {
                const button = document.createElement('button');
                button.className = 'choice-btn';
                button.textContent = choice.text;
                button.addEventListener('click', () => selectChoice(index, choice.correct));
                interactiveElements.choiceButtons.appendChild(button);
            });
        }

        // Select choice in scenario
        function selectChoice(index, isCorrect) {
            const buttons = interactiveElements.choiceButtons.querySelectorAll('.choice-btn');
            const scenario = scenarios[currentScenario];
            
            // Disable all buttons and show results
            buttons.forEach((btn, i) => {
                btn.disabled = true;
                if (i === index) {
                    btn.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                if (scenario.choices[i].correct) {
                    btn.classList.add('correct');
                }
            });
            
            // Show feedback
            interactiveElements.scenarioFeedback.textContent = isCorrect ? 
                scenario.feedback.correct : scenario.feedback.incorrect;
            interactiveElements.scenarioFeedback.className = `feedback show ${isCorrect ? 'correct' : 'incorrect'}`;
            
            if (isCorrect) {
                createConfetti();
            }
        }

        // Next scenario
        function nextScenario() {
            currentScenario = (currentScenario + 1) % scenarios.length;
            loadScenario();
        }

        // Mood selection
        function selectMood(mood) {
            // Remove previous selection
            interactiveElements.moodFaces.forEach(face => {
                face.classList.remove('selected');
            });
            
            // Add selection to clicked face
            event.target.classList.add('selected');
            
            // Show appropriate message
            const messages = {
                'très triste': 'Je comprends que tu te sentes mal. N\'hésite pas à parler à quelqu\'un de confiance. Tu n\'es pas seul(e).',
                'triste': 'C\'est normal d\'avoir des moments difficiles. Prendre soin de soi est important.',
                'neutre': 'C\'est bien d\'être en équilibre. Continue à prendre soin de ton bien-être.',
                'content': 'C\'est formidable ! Profite de ces moments positifs.',
                'très content': 'Quelle joie ! Ton énergie positive peut aider les autres autour de toi.'
            };
            
            interactiveElements.moodMessage.textContent = messages[mood];
        }

        // Tips carousel
        function showTipSlide(slideIndex) {
            const slides = document.querySelectorAll('.tip-slide');
            const dots = interactiveElements.tipDots;
            
            // Hide all slides
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));
            
            // Show selected slide
            slides[slideIndex].classList.add('active');
            dots[slideIndex].classList.add('active');
            
            currentTipSlide = slideIndex;
        }

        // Breathing exercise
        function startBreathingExercise() {
            let isInhaling = true;
            let cycleCount = 0;
            
            breathingInterval = setInterval(() => {
                if (isInhaling) {
                    interactiveElements.breathingCircle.classList.remove('exhale');
                    interactiveElements.breathingCircle.classList.add('inhale');
                    interactiveElements.breathingCircle.textContent = 'Inspirez';
                } else {
                    interactiveElements.breathingCircle.classList.remove('inhale');
                    interactiveElements.breathingCircle.classList.add('exhale');
                    interactiveElements.breathingCircle.textContent = 'Expirez';
                    cycleCount++;
                    
                    // Unlock zen master badge after 5 breathing cycles
                    if (cycleCount >= 5) {
                        unlockBadge('zen-master');
                    }
                }
                isInhaling = !isInhaling;
            }, 4000);
        }

        function stopBreathingExercise() {
            clearInterval(breathingInterval);
            interactiveElements.breathingCircle.classList.remove('inhale', 'exhale');
            interactiveElements.breathingCircle.textContent = 'Respirez';
        }

        // Sound effect for interactions
        function playClickSound() {
            // Create visual sound wave effect
            const soundWave = document.createElement('div');
            soundWave.className = 'sound-wave';
            document.body.appendChild(soundWave);
            soundWave.style.opacity = '1';
            
            setTimeout(() => {
                soundWave.remove();
            }, 600);
        }

        // Badge system
        let unlockedBadges = new Set();
        
        function unlockBadge(badgeId) {
            if (unlockedBadges.has(badgeId)) return;
            
            unlockedBadges.add(badgeId);
            const badgeElement = document.querySelector(`[data-badge="${badgeId}"]`);
            if (badgeElement) {
                badgeElement.classList.remove('locked');
                badgeElement.classList.add('unlocked');
                createConfetti();
                
                // Show notification
                showNotification(`🏆 Badge débloqué : ${badgeElement.querySelector('.badge-name').textContent}!`);
            }
            
            updateOverallProgress();
        }
        
        function updateOverallProgress() {
            const totalBadges = 6;
            const progress = (unlockedBadges.size / totalBadges) * 100;
            const progressDegrees = (progress / 100) * 360;
            
            interactiveElements.overallProgress.style.background = 
                `conic-gradient(#667eea ${progressDegrees}deg, #e0e0e0 ${progressDegrees}deg)`;
            interactiveElements.progressPercent.textContent = Math.round(progress) + '%';
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 1001;
                animation: slideInRight 0.5s ease;
                max-width: 300px;
                font-weight: bold;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }
        
        // Chatbot functionality
        const chatResponses = {
            'harcèlement': 'Le harcèlement est un problème sérieux. Si tu en es victime, parle-en à un adulte de confiance. Tu n\'es pas seul(e) et ce n\'est pas de ta faute.',
            'triste': 'Je comprends que tu te sentes triste. C\'est normal d\'avoir des émotions difficiles. As-tu essayé l\'exercice de respiration ? Il peut t\'aider à te sentir mieux.',
            'peur': 'La peur est une émotion normale face au harcèlement. Il est important de ne pas rester seul(e) avec cette peur. Parler à quelqu\'un peut vraiment aider.',
            'aide': 'Je suis là pour t\'aider ! Tu peux me parler de tes préoccupations, utiliser les exercices de respiration, ou explorer les conseils pratiques.',
            'bonjour': 'Bonjour ! Je suis ravi de te parler. Comment te sens-tu aujourd\'hui ? Y a-t-il quelque chose qui te préoccupe ?',
            'merci': 'De rien ! Je suis là pour t\'accompagner. N\'hésite pas à revenir me parler quand tu en as besoin.',
            'default': 'Je comprends tes préoccupations. Souviens-toi que tu n\'es pas seul(e). Si tu vis une situation difficile, n\'hésite pas à en parler à un adulte de confiance.'
        };
        
        function sendChatMessage() {
            const message = interactiveElements.chatInput.value.trim();
            if (!message) return;
            
            // Add user message
            addChatMessage(message, 'user');
            interactiveElements.chatInput.value = '';
            
            // Generate bot response
            setTimeout(() => {
                const response = generateBotResponse(message);
                addChatMessage(response, 'bot');
                unlockBadge('helper');
            }, 1000);
        }
        
        function addChatMessage(message, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = sender === 'user' ? 'user-message' : 'bot-message';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${sender === 'user' ? '👤' : '🤖'}</div>
                <div class="message-content">${message}</div>
            `;
            
            interactiveElements.chatMessages.appendChild(messageDiv);
            interactiveElements.chatMessages.scrollTop = interactiveElements.chatMessages.scrollHeight;
        }
        
        function generateBotResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            for (const [keyword, response] of Object.entries(chatResponses)) {
                if (lowerMessage.includes(keyword)) {
                    return response;
                }
            }
            
            return chatResponses.default;
        }
        
        // Emotion detector
        function scanEmotions() {
            const scanningLine = interactiveElements.scannerFrame.querySelector('.scanning-line');
            const facePlaceholder = interactiveElements.scannerFrame.querySelector('.face-placeholder');
            
            // Start scanning animation
            scanningLine.classList.add('active');
            
            // Change face during scan
            const faces = ['😐', '🤔', '😊', '😔', '😰', '😌'];
            let faceIndex = 0;
            const faceInterval = setInterval(() => {
                facePlaceholder.textContent = faces[faceIndex % faces.length];
                faceIndex++;
            }, 300);
            
            setTimeout(() => {
                scanningLine.classList.remove('active');
                clearInterval(faceInterval);
                
                // Generate random emotion results
                const emotions = {
                    joy: Math.random() * 100,
                    sadness: Math.random() * 100,
                    stress: Math.random() * 100,
                    confidence: Math.random() * 100
                };
                
                // Normalize to 100%
                const total = Object.values(emotions).reduce((a, b) => a + b, 0);
                Object.keys(emotions).forEach(key => {
                    emotions[key] = (emotions[key] / total) * 100;
                });
                
                // Update emotion bars
                Object.entries(emotions).forEach(([emotion, value]) => {
                    const bar = document.querySelector(`.fill.${emotion}`);
                    const percentage = document.querySelector(`.emotion-bar:has(.${emotion}) .percentage`);
                    
                    if (bar && percentage) {
                        bar.style.width = value + '%';
                        percentage.textContent = Math.round(value) + '%';
                    }
                });
                
                // Show advice based on dominant emotion
                const dominantEmotion = Object.keys(emotions).reduce((a, b) => 
                    emotions[a] > emotions[b] ? a : b
                );
                
                const advice = {
                    joy: '😊 Vous semblez joyeux ! C\'est formidable. Partagez cette énergie positive avec les autres.',
                    sadness: '😔 Je détecte de la tristesse. N\'hésitez pas à parler à quelqu\'un ou à essayer l\'exercice de respiration.',
                    stress: '😰 Vous paraissez stressé. L\'exercice de respiration pourrait vous aider à vous détendre.',
                    confidence: '😌 Vous dégagez de la confiance ! C\'est une excellente base pour affronter les défis.'
                };
                
                interactiveElements.emotionAdvice.textContent = advice[dominantEmotion];
                interactiveElements.emotionAdvice.classList.add('show');
                
                unlockBadge('emotion-master');
            }, 3000);
        }
        
        // Mini-games
        let currentGame = null;
        let gameScores = { memory: 0, reaction: 0, empathy: 0 };
        let gamesPlayed = new Set();
        
        function showGame(gameType) {
            // Hide all games
            document.querySelectorAll('.game-area').forEach(area => {
                area.style.display = 'none';
            });
            
            // Show selected game
            document.getElementById(gameType + 'Game').style.display = 'block';
            currentGame = gameType;
            gamesPlayed.add(gameType);
            
            if (gamesPlayed.size === 3) {
                unlockBadge('gamer');
            }
            
            // Initialize game
            switch(gameType) {
                case 'memory':
                    initMemoryGame();
                    break;
                case 'reaction':
                    initReactionGame();
                    break;
                case 'empathy':
                    initEmpathyGame();
                    break;
            }
        }
        
        function initMemoryGame() {
            const emotions = ['😊', '😢', '😠', '😰', '😴', '🤔'];
            let sequence = [];
            let playerSequence = [];
            let level = 1;
            
            function startLevel() {
                sequence.push(emotions[Math.floor(Math.random() * emotions.length)]);
                showSequence();
            }
            
            function showSequence() {
                const sequenceDiv = document.getElementById('memorySequence');
                sequenceDiv.innerHTML = '';
                
                sequence.forEach((emotion, index) => {
                    setTimeout(() => {
                        const tile = document.createElement('div');
                        tile.className = 'emotion-tile active';
                        tile.textContent = emotion;
                        sequenceDiv.appendChild(tile);
                        
                        setTimeout(() => {
                            tile.classList.remove('active');
                        }, 500);
                    }, index * 600);
                });
                
                setTimeout(() => {
                    setupInput();
                }, sequence.length * 600 + 500);
            }
            
            function setupInput() {
                const inputDiv = document.getElementById('memoryInput');
                inputDiv.innerHTML = '';
                playerSequence = [];
                
                emotions.forEach(emotion => {
                    const tile = document.createElement('div');
                    tile.className = 'emotion-tile';
                    tile.textContent = emotion;
                    tile.addEventListener('click', () => selectEmotion(emotion, tile));
                    inputDiv.appendChild(tile);
                });
            }
            
            function selectEmotion(emotion, tile) {
                playerSequence.push(emotion);
                tile.classList.add('active');
                
                if (playerSequence.length === sequence.length) {
                    checkSequence();
                }
            }
            
            function checkSequence() {
                const correct = playerSequence.every((emotion, index) => 
                    emotion === sequence[index]
                );
                
                if (correct) {
                    gameScores.memory += 10;
                    document.getElementById('memoryScore').textContent = gameScores.memory;
                    level++;
                    setTimeout(startLevel, 1000);
                } else {
                    alert(`Niveau ${level - 1} terminé ! Score final: ${gameScores.memory}`);
                    sequence = [];
                    level = 1;
                }
            }
            
            startLevel();
        }
        
        function initReactionGame() {
            const circle = document.getElementById('reactionCircle');
            let startTime;
            let timeout;
            
            function startReaction() {
                circle.textContent = 'Attendez...';
                circle.className = 'reaction-circle';
                
                timeout = setTimeout(() => {
                    circle.textContent = 'CLIQUEZ !';
                    circle.classList.add('ready');
                    startTime = Date.now();
                }, Math.random() * 3000 + 1000);
            }
            
            circle.addEventListener('click', () => {
                if (circle.classList.contains('ready')) {
                    const reactionTime = Date.now() - startTime;
                    document.getElementById('reactionTime').textContent = reactionTime;
                    circle.classList.add('clicked');
                    
                    setTimeout(() => {
                        startReaction();
                    }, 2000);
                } else {
                    clearTimeout(timeout);
                    circle.textContent = 'Trop tôt ! Attendez le vert.';
                    setTimeout(startReaction, 2000);
                }
            });
            
            startReaction();
        }
        
        function initEmpathyGame() {
            const emotions = [
                { face: '😊', name: 'Joie' },
                { face: '😢', name: 'Tristesse' },
                { face: '😠', name: 'Colère' },
                { face: '😰', name: 'Peur' },
                { face: '🤔', name: 'Réflexion' },
                { face: '😴', name: 'Fatigue' }
            ];
            
            let currentEmotion;
            
            function newQuestion() {
                currentEmotion = emotions[Math.floor(Math.random() * emotions.length)];
                document.getElementById('empathyFace').textContent = currentEmotion.face;
                
                const choicesDiv = document.getElementById('empathyChoices');
                choicesDiv.innerHTML = '';
                
                // Create shuffled choices
                const shuffled = [...emotions].sort(() => Math.random() - 0.5).slice(0, 4);
                if (!shuffled.includes(currentEmotion)) {
                    shuffled[0] = currentEmotion;
                    shuffled.sort(() => Math.random() - 0.5);
                }
                
                shuffled.forEach(emotion => {
                    const choice = document.createElement('div');
                    choice.className = 'empathy-choice';
                    choice.textContent = emotion.name;
                    choice.addEventListener('click', () => checkAnswer(emotion));
                    choicesDiv.appendChild(choice);
                });
            }
            
            function checkAnswer(selected) {
                if (selected.name === currentEmotion.name) {
                    gameScores.empathy += 10;
                    document.getElementById('empathyScore').textContent = gameScores.empathy;
                    createConfetti();
                }
                
                setTimeout(newQuestion, 1500);
            }
            
            newQuestion();
        }
        
        // New features functions
        function showQuote() {
            const quote = inspirationalQuotes[currentQuoteIndex];
            document.getElementById('quoteText').textContent = `"${quote.text}"`;
            document.getElementById('quoteAuthor').textContent = `- ${quote.author}`;
        }

        function newQuote() {
            currentQuoteIndex = Math.floor(Math.random() * inspirationalQuotes.length);
            showQuote();
            createConfetti();
        }

        function favoriteQuote() {
            const quote = inspirationalQuotes[currentQuoteIndex];
            if (!favoriteQuotes.includes(quote)) {
                favoriteQuotes.push(quote);
                showNotification('Citation ajoutée aux favoris ! ❤️');
            } else {
                showNotification('Cette citation est déjà dans vos favoris !');
            }
        }

        function shareQuote() {
            const quote = inspirationalQuotes[currentQuoteIndex];
            const text = `"${quote.text}" - ${quote.author}`;
            
            if (navigator.share) {
                navigator.share({ text: text });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    showNotification('Citation copiée dans le presse-papiers ! 📋');
                });
            }
        }

        function saveJournalEntry() {
            const text = document.getElementById('journalText').value.trim();
            if (!text) {
                showNotification('Écrivez quelque chose avant de sauvegarder !');
                return;
            }

            const entry = {
                date: new Date().toLocaleDateString('fr-FR'),
                text: text,
                wordCount: text.split(' ').length
            };

            journalEntries.push(entry);
            updateJournalStats();
            showNotification('Entrée sauvegardée ! 💾');
            document.getElementById('journalText').value = '';
        }

        function clearJournalEntry() {
            document.getElementById('journalText').value = '';
            showNotification('Texte effacé !');
        }

        function updateJournalStats() {
            const totalWords = journalEntries.reduce((sum, entry) => sum + entry.wordCount, 0);
            document.getElementById('entriesCount').textContent = journalEntries.length;
            document.getElementById('wordsCount').textContent = totalWords;
            document.getElementById('streakCount').textContent = Math.min(journalEntries.length, 7);
        }

        function startMeditation(type) {
            if (!type) return;
            
            currentMeditation = meditationPrograms[type];
            meditationStep = 0;
            
            const meditationText = document.getElementById('meditationText');
            const meditationTime = document.getElementById('meditationTime');
            
            let seconds = 0;
            meditationTimer = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                meditationTime.textContent = 
                    `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                
                if (seconds % 30 === 0 && meditationStep < currentMeditation.steps.length) {
                    meditationText.textContent = currentMeditation.steps[meditationStep];
                    meditationStep++;
                }
            }, 1000);
            
            meditationText.textContent = currentMeditation.steps[0];
            showNotification(`Méditation ${currentMeditation.name} commencée 🧘`);
        }

        function stopMeditation() {
            if (meditationTimer) {
                clearInterval(meditationTimer);
                meditationTimer = null;
                document.getElementById('meditationText').textContent = 'Méditation terminée. Prenez un moment pour revenir doucement.';
                showNotification('Méditation terminée ! Bien joué ! 🌟');
                unlockBadge('zen-master');
            }
        }

        function updateAvatar(type, value) {
            avatarConfig[type] = value;
            document.querySelector(`.avatar-${type}`).textContent = value;
            
            // Update selection visual
            document.querySelectorAll(`[data-type="${type}"]`).forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`[data-type="${type}"][data-value="${value}"]`).classList.add('selected');
        }

        function saveAvatar() {
            showNotification('Avatar sauvegardé ! 👤');
            createConfetti();
        }

        function toggleSound(soundType) {
            const soundCard = document.querySelector(`[data-sound="${soundType}"]`);
            const visualizer = document.getElementById(`${soundType}Viz`);
            
            if (activeSounds.has(soundType)) {
                activeSounds.delete(soundType);
                soundCard.classList.remove('active');
                visualizer.classList.remove('active');
            } else {
                activeSounds.add(soundType);
                soundCard.classList.add('active');
                visualizer.classList.add('active');
            }
        }

        function playAllSounds() {
            const soundTypes = ['rain', 'forest', 'ocean', 'birds'];
            soundTypes.forEach(sound => {
                if (!activeSounds.has(sound)) {
                    toggleSound(sound);
                }
            });
            showNotification('Toutes les ambiances sont activées ! 🎵');
        }

        function stopAllSounds() {
            activeSounds.forEach(sound => toggleSound(sound));
            showNotification('Toutes les ambiances sont arrêtées !');
        }

        function startStory(storyType) {
            currentStory = interactiveStories[storyType];
            currentChapter = 0;
            showStoryChapter();
        }

        function showStoryChapter() {
            if (!currentStory) return;
            
            const chapter = currentStory.chapters[currentChapter];
            const storyText = document.getElementById('storyText');
            const storyChoices = document.getElementById('storyChoices');
            const storyProgress = document.getElementById('storyProgress');
            
            storyText.textContent = chapter.text;
            storyChoices.innerHTML = '';
            
            chapter.choices.forEach(choice => {
                const choiceBtn = document.createElement('div');
                choiceBtn.className = 'story-choice';
                choiceBtn.textContent = choice.text;
                choiceBtn.addEventListener('click', () => {
                    if (choice.next !== undefined) {
                        currentChapter = choice.next;
                        showStoryChapter();
                    }
                });
                storyChoices.appendChild(choiceBtn);
            });
            
            const progress = ((currentChapter + 1) / currentStory.chapters.length) * 100;
            storyProgress.style.width = progress + '%';
            storyProgress.textContent = Math.round(progress) + '%';
            
            if (chapter.choices.length === 0) {
                showNotification('Histoire terminée ! Bravo ! 📚');
                createConfetti();
            }
        }

        // Event listeners for interactive features
        interactiveElements.themeToggle.addEventListener('click', toggleTheme);
        interactiveElements.scenarioBtn.addEventListener('click', () => {
            showSimulator('scenario');
            playClickSound();
        });
        interactiveElements.moodBtn.addEventListener('click', () => {
            showSimulator('mood');
            playClickSound();
        });
        interactiveElements.tipsBtn.addEventListener('click', () => {
            showSimulator('tips');
            playClickSound();
        });
        interactiveElements.breathingBtn.addEventListener('click', () => {
            showSimulator('breathing');
            playClickSound();
        });
        interactiveElements.chatbotBtn.addEventListener('click', () => {
            showSimulator('chatbot');
            playClickSound();
        });
        interactiveElements.emotionBtn.addEventListener('click', () => {
            showSimulator('emotion');
            playClickSound();
        });
        interactiveElements.gameBtn.addEventListener('click', () => {
            showSimulator('game');
            playClickSound();
        });
        interactiveElements.badgeBtn.addEventListener('click', () => {
            showSimulator('badge');
            playClickSound();
        });
        interactiveElements.quoteBtn.addEventListener('click', () => {
            showSimulator('quote');
            playClickSound();
        });
        interactiveElements.journalBtn.addEventListener('click', () => {
            showSimulator('journal');
            playClickSound();
        });
        interactiveElements.meditationBtn.addEventListener('click', () => {
            showSimulator('meditation');
            playClickSound();
        });
        interactiveElements.avatarBtn.addEventListener('click', () => {
            showSimulator('avatar');
            playClickSound();
        });
        interactiveElements.musicBtn.addEventListener('click', () => {
            showSimulator('music');
            playClickSound();
        });
        interactiveElements.storyBtn.addEventListener('click', () => {
            showSimulator('story');
            playClickSound();
        });
        interactiveElements.nextScenario.addEventListener('click', nextScenario);
        interactiveElements.startBreathing.addEventListener('click', startBreathingExercise);
        interactiveElements.stopBreathing.addEventListener('click', stopBreathingExercise);
        interactiveElements.sendMessage.addEventListener('click', sendChatMessage);
        interactiveElements.chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendChatMessage();
        });
        interactiveElements.scanEmotion.addEventListener('click', scanEmotions);
        interactiveElements.gameSelectors.forEach(btn => {
            btn.addEventListener('click', (e) => {
                showGame(e.target.dataset.game);
                playClickSound();
            });
        });

        // New features event listeners
        document.getElementById('newQuote').addEventListener('click', newQuote);
        document.getElementById('favoriteQuote').addEventListener('click', favoriteQuote);
        document.getElementById('shareQuote').addEventListener('click', shareQuote);
        document.getElementById('saveEntry').addEventListener('click', saveJournalEntry);
        document.getElementById('clearEntry').addEventListener('click', clearJournalEntry);
        document.getElementById('startMeditation').addEventListener('click', () => {
            const selectedType = document.querySelector('.meditation-type.selected');
            if (selectedType) {
                startMeditation(selectedType.dataset.type);
            } else {
                showNotification('Choisissez d\'abord un type de méditation !');
            }
        });
        document.getElementById('stopMeditation').addEventListener('click', stopMeditation);
        document.getElementById('saveAvatar').addEventListener('click', saveAvatar);
        document.getElementById('playAllSounds').addEventListener('click', playAllSounds);
        document.getElementById('stopAllSounds').addEventListener('click', stopAllSounds);

        // Meditation type selection
        document.querySelectorAll('.meditation-type').forEach(btn => {
            btn.addEventListener('click', (e) => {
                document.querySelectorAll('.meditation-type').forEach(b => b.classList.remove('selected'));
                e.target.classList.add('selected');
                playClickSound();
            });
        });

        // Avatar customization
        document.querySelectorAll('.avatar-option').forEach(btn => {
            btn.addEventListener('click', (e) => {
                updateAvatar(e.target.dataset.type, e.target.dataset.value);
                playClickSound();
            });
        });

        // Sound cards
        document.querySelectorAll('.sound-card').forEach(card => {
            card.addEventListener('click', (e) => {
                const soundType = e.currentTarget.dataset.sound;
                toggleSound(soundType);
                playClickSound();
            });
        });

        // Story selection
        document.querySelectorAll('.story-select').forEach(btn => {
            btn.addEventListener('click', (e) => {
                startStory(e.target.dataset.story);
                playClickSound();
            });
        });

        // Mood faces event listeners
        interactiveElements.moodFaces.forEach(face => {
            face.addEventListener('click', (e) => {
                selectMood(e.target.dataset.mood);
                playClickSound();
            });
        });

        // Tips navigation
        interactiveElements.tipDots.forEach((dot, index) => {
            dot.addEventListener('click', () => {
                showTipSlide(index);
                playClickSound();
            });
        });

        // Auto-advance tips carousel
        setInterval(() => {
            if (interactiveElements.tipsSim.classList.contains('active')) {
                const nextSlide = (currentTipSlide + 1) % 4;
                showTipSlide(nextSlide);
            }
        }, 8000);

        // Add click sound to existing buttons
        document.querySelectorAll('.btn').forEach(btn => {
            btn.addEventListener('click', playClickSound);
        });

        // Initialize interactive features
        createParticles();
        showQuote(); // Initialize with first quote
        updateJournalStats();
        
        // Initialize
        updateStats();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9852bdc06463e191',t:'MTc1ODg4OTQ5Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
